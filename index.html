<!DOCTYPE html>
<html lang="en"><head>
<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/tabby.min.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-99.9.9">

  <meta name="author" content="Joe Cheng">
  <meta name="dcterms.date" content="2016-01-30">
  <title>Principles of Reactivity</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="index_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="index_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #f8f8f2;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #f8f8f2; } /* Normal */
    code span.al { color: #f07178; background-color: #2a0f15; font-weight: bold; } /* Alert */
    code span.an { color: #d4d0ab; } /* Annotation */
    code span.at { color: #00e0e0; } /* Attribute */
    code span.bn { color: #d4d0ab; } /* BaseN */
    code span.bu { color: #abe338; } /* BuiltIn */
    code span.cf { color: #ffa07a; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #abe338; } /* Char */
    code span.cn { color: #ffd700; } /* Constant */
    code span.co { color: #f8f8f2; font-style: italic; } /* Comment */
    code span.cv { color: #ffd700; } /* CommentVar */
    code span.do { color: #f8f8f2; } /* Documentation */
    code span.dt { color: #ffa07a; } /* DataType */
    code span.dv { color: #d4d0ab; } /* DecVal */
    code span.er { color: #f07178; text-decoration: underline; } /* Error */
    code span.ex { color: #00e0e0; font-weight: bold; } /* Extension */
    code span.fl { color: #d4d0ab; } /* Float */
    code span.fu { color: #ffa07a; } /* Function */
    code span.im { color: #abe338; } /* Import */
    code span.in { color: #d4d0ab; } /* Information */
    code span.kw { color: #ffa07a; font-weight: bold; } /* Keyword */
    code span.op { color: #ffa07a; } /* Operator */
    code span.ot { color: #00e0e0; } /* Other */
    code span.pp { color: #dcc6e0; } /* Preprocessor */
    code span.re { color: #00e0e0; background-color: #f8f8f2; } /* RegionMarker */
    code span.sc { color: #abe338; } /* SpecialChar */
    code span.ss { color: #abe338; } /* SpecialString */
    code span.st { color: #abe338; } /* String */
    code span.va { color: #00e0e0; } /* Variable */
    code span.vs { color: #abe338; } /* VerbatimString */
    code span.wa { color: #dcc6e0; } /* Warning */
  </style>
  <link rel="stylesheet" href="index_files/libs/revealjs/dist/theme/quarto.css" id="theme">
  <link href="index_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="index_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="index_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="index_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-captioned.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-captioned) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-captioned.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-captioned .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-captioned .callout-caption  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-captioned.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-captioned.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-caption {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-caption {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-caption {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-captioned .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-captioned .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-captioned) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-caption {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-caption {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-caption {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-caption {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-caption {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-dark">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="center">
  <h1 class="title">Principles of Reactivity</h1>
  <p class="author">Joe Cheng</p>
  <p class="date">2016-01-30</p>
</section>

<section id="warm-up-side-effects" class="slide level2">
<h2>Warm up: Side effects</h2>
<p>Functions can be executed for one or both of the following reasons:</p>
<ol type="1">
<li>You want its return value.</li>
<li>You want it to have <strong>some other effect</strong>.</li>
</ol>
<div class="fragment">
<p>These are (a bit misleadingly) called <em>side effects</em>. Any effect that is not the return value is a side effect.</p>
</div>
</section>
<section id="functions-with-side-effects" class="slide level2">
<h2>Functions with side effects</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">write.csv</span>(...)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">plot</span>(cars)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">print</span>(x)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="fu">httr.POST</span>(...)</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="fu">alarm</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="more-side-effects" class="slide level2">
<h2>More side effects</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># Sets a variable in a parent environment</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>value <span class="ot">&lt;&lt;-</span> <span class="dv">10</span></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co"># Loads into global env by default</span></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="fu">source</span>(<span class="st">"functions.R"</span>)</span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="co"># Modifies the global search list</span></span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="co"># Only if foo is an env, ref class, or R6</span></span>
<span id="cb2-8"><a href="#cb2-8"></a>foo<span class="sc">$</span>bar <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="not-side-effects-when-inside-a-function" class="slide level2">
<h2>NOT side effects (when inside a function)</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># Modifying *local* variables</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>value <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="co"># Creating most kinds of objects</span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="fu">list</span>(<span class="at">a =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">2</span>)</span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="co"># Data frames are pass-by-value in R so this is OK</span></span>
<span id="cb3-6"><a href="#cb3-6"></a>dataset <span class="ot">&lt;-</span> dataset <span class="sc">%&gt;%</span> <span class="fu">filter</span>(count <span class="sc">&gt;</span> <span class="dv">3</span>)</span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="co"># Most calculations</span></span>
<span id="cb3-8"><a href="#cb3-8"></a>a <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="fu">summary</span>(pressure)</span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="fu">lm</span>(speed <span class="sc">~</span> dist, <span class="at">data =</span> cars)</span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="fu">predict</span>(wfit, <span class="at">interval =</span> <span class="st">"prediction"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="ehhh-not-side-effects" class="slide level2">
<h2>Ehhh… Not side effects</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># Reading from disk</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="fu">readLines</span>(<span class="st">"data.csv"</span>)</span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="co"># Making HTTP GET requests</span></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="fu">httr.GET</span>(<span class="st">"https://api.example.com/data.json"</span>)</span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="co"># Reading global variables</span></span>
<span id="cb4-6"><a href="#cb4-6"></a>.Random.seed</span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="co"># Modifying the random seed... ehhhhhh...</span></span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="fu">runif</span>(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>If executing your function/expression <strong>leaves the state of the world a little different</strong> than before it executed, <strong>it has side effects</strong>.</p>
<p>But if “what happens in <code>func</code>, stays in <code>func</code>” (besides the return value), then it doesn’t have side effects.</p>
</section>
<section id="side-effect-quiz" class="slide level2">
<h2>Side effect quiz</h2>
<p>For each function, write Yes if it has side effects, and No if not.</p>
</section>
<section id="question-1" class="slide level2">
<h2>Question 1</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="cf">function</span>(a, b) {</span>
<span id="cb5-2"><a href="#cb5-2"></a>  (b <span class="sc">-</span> a) <span class="sc">/</span> a</span>
<span id="cb5-3"><a href="#cb5-3"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="question-2" class="slide level2">
<h2>Question 2</h2>
<div class="sourceCode" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="cf">function</span>(values) {</span>
<span id="cb6-2"><a href="#cb6-2"></a>  <span class="fu">globalenv</span>()<span class="sc">$</span>values <span class="ot">&lt;-</span> values</span>
<span id="cb6-3"><a href="#cb6-3"></a>  values</span>
<span id="cb6-4"><a href="#cb6-4"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="question-3" class="slide level2">
<h2>Question 3</h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="cf">function</span>() {</span>
<span id="cb7-2"><a href="#cb7-2"></a>  <span class="fu">options</span>(<span class="at">digits.secs =</span> <span class="dv">6</span>)</span>
<span id="cb7-3"><a href="#cb7-3"></a>  <span class="fu">as.character</span>(<span class="fu">Sys.time</span>())</span>
<span id="cb7-4"><a href="#cb7-4"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="question-4" class="slide level2">
<h2>Question 4</h2>
<div class="sourceCode" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="cf">function</span>(df) {</span>
<span id="cb8-2"><a href="#cb8-2"></a>  df<span class="sc">$</span>foo <span class="ot">&lt;-</span> <span class="fu">factor</span>(df<span class="sc">$</span>foo)</span>
<span id="cb8-3"><a href="#cb8-3"></a>  df</span>
<span id="cb8-4"><a href="#cb8-4"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="question-5" class="slide level2">
<h2>Question 5</h2>
<div class="sourceCode" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="cf">function</span>() {</span>
<span id="cb9-2"><a href="#cb9-2"></a>  <span class="fu">readLines</span>(<span class="st">"~/data/raw.txt"</span>)</span>
<span id="cb9-3"><a href="#cb9-3"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="question-6" class="slide level2">
<h2>Question 6</h2>
<div class="sourceCode" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="cf">function</span>(values) {</span>
<span id="cb10-2"><a href="#cb10-2"></a>  <span class="fu">hist</span>(values, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-3"><a href="#cb10-3"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="question-7" class="slide level2">
<h2>Question 7</h2>
<div class="sourceCode" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="cf">function</span>() {</span>
<span id="cb11-2"><a href="#cb11-2"></a>  <span class="co"># Create temp file, and delete when function exits</span></span>
<span id="cb11-3"><a href="#cb11-3"></a>  filePath <span class="ot">&lt;-</span> <span class="fu">tempfile</span>(<span class="at">fileext =</span> <span class="st">".png"</span>)</span>
<span id="cb11-4"><a href="#cb11-4"></a>  <span class="fu">on.exit</span>(<span class="fu">file.unlink</span>(filePath))</span>
<span id="cb11-5"><a href="#cb11-5"></a>  <span class="co"># Plot to the temp file as PNG image</span></span>
<span id="cb11-6"><a href="#cb11-6"></a>  <span class="fu">png</span>(filePath); <span class="fu">plot</span>(cars); <span class="fu">dev.off</span>()</span>
<span id="cb11-7"><a href="#cb11-7"></a>  <span class="co"># Return the contents of the temp file</span></span>
<span id="cb11-8"><a href="#cb11-8"></a>  <span class="fu">readBin</span>(filePath, <span class="st">"raw"</span>, <span class="at">n =</span> <span class="fu">file.info</span>(filePath)<span class="sc">$</span>size)</span>
<span id="cb11-9"><a href="#cb11-9"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="answers" class="slide level2">
<h2>Answers</h2>
<ol type="1">
<li class="fragment">No</li>
<li class="fragment">Yes</li>
<li class="fragment">Yes</li>
<li class="fragment">No</li>
<li class="fragment">No</li>
<li class="fragment">Yes</li>
<li class="fragment">Mostly no</li>
</ol>
</section>
<section id="section" class="slide level2">
<h2></h2>
<p><strong>Side effects make code harder to reason about,</strong> since order of execution of different side-effect functions can matter (in non-obvious ways).</p>
<p><strong>But we still need them.</strong> Without side effects, our programs are useless! (If a program executes but has no observable interactions with the world, you may as well have not executed it at all!)</p>
</section>
<section id="reactive-programming" class="slide level2">
<h2>Reactive programming</h2>
<aside class="notes">
<p>Reactivity can be your best friend—or your worst enemy. If you follow some rules of the road, and trust them, then you’ll end up moving in the right direction.</p>
<p>We haven’t been very upfront about these rules; mostly I’ve disseminated them in replies to shiny-discuss threads. So even if you’ve been following Shiny development pretty closely, it’s quite likely that some of the things I’ll discuss today will be news to you.</p>
<p>One of my top priorities in 2016 is to get the message out there about how to use reactivity properly, and it starts right here, at this conference, in this tutorial. So your feedback is <em>most</em> welcome after the tutorial.</p>
<p>You ignore these principles at your peril! The temptation is especially strong among smart, experienced programmers. Resist it—at least until you’ve tried to do it the right way first. These aren’t rules that people say but don’t expect anyone to completely follow, like “write unit tests for every function”, “floss after every meal”, etc. These are more like, “bring your car to a stop when you come to a stop sign”.</p>
<p>If you’ve tried to do it the right way and still really want to break these rules, email me at joe@rstudio.com and let’s talk about it. But please, do that before sinking weeks or months into your app, while I can still help you!</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="ladder-of-enlightenment" class="slide level2">
<h2>Ladder of Enlightenment</h2>
<ol type="1">
<li class="fragment">Made it halfway through the tutorial. Has used <code>output</code> and <code>input</code>.</li>
<li class="fragment">Made it entirely through the tutorial. Has used reactive expressions (<code>reactive()</code>).</li>
<li class="fragment">Has used <code>observe()</code> and/or <code>observeEvent()</code>. Has written reactive expressions that depend on other reactive expressions. Has used <code>isolate()</code> properly.</li>
<li class="fragment">Can say confidently when to use <code>reactive()</code> vs.&nbsp;<code>observe()</code>. Has used <code>invalidateLater</code>.</li>
<li class="fragment">Writes higher-order reactives (functions that have reactive expressions as input parameters and return values).</li>
<li class="fragment">Understands that reactive expressions are monads.</li>
</ol>
<aside class="notes">
<p>I’d like to propose a ladder of Shiny reactivity “enlightenment”.</p>
<p>Take a moment to read this list, then discuss with the people around you where you currently rank. Don’t be shy or embarrassed if you’re at level one or two, we’re all here to learn! Go ahead, I’ll give you three minutes.</p>
<p>How many of you feel like you’re at levels one or two?</p>
<p>How many are at level three?</p>
<p>How many are at level four?</p>
<p>Anyone besides Hadley and Winston at five or six?</p>
<p>So at level three, you can write quite complicated applications. And many of you have. This is a dangerous zone. Your apps generally work, but sometimes you struggle with why things are executing too much, or not enough. Each new feature you add to your app seems to increase the overall complexity superlinearly.</p>
<p>Our goal today is to get everyone, or at least most of you, to level four. When you have a firm grasp on the reactive primitives we’ve built into Shiny, you can build complicated networks of reactive expressions and observers, with confidence. Combine that knowledge with the new modules feature, which Garrett will talk about tomorrow, and you’ve got all the tools you need to write large yet maintainable Shiny apps.</p>
<p>Level five or six is where the real fun begins. We won’t get there today, but if you’re interested in learning more, please let me know! I’d love to talk to you. Maybe we can organize a group vchat or webinar or something, and eventually spin that in to an article or three.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="exercise-00" class="slide level2">
<h2>Exercise 00</h2>
<p>Open <code>Exercise_00.R</code> and complete the server function. Make the plot output show a simple plot of the first <code>nrows</code> rows of a built-in dataset.</p>
<p>You have 5 minutes!</p>
<p>Hint: <code>plot(head(cars, nrows))</code></p>
<aside class="notes">
<p>We’ll get started with a really basic example app, just to get the juices flowing a little bit.</p>
<p>Open up Exercise_00.R; it should be in your Files pane. You should see the beginnings of a Shiny app. The UI definition is complete, but the server function is blank. I want you to fill in that server function. Make the plot output show a simple plot of the first <code>nrows</code> rows of a built-in dataset of your choice. If you can’t think of any, use <code>cars</code>.</p>
<p>So basically, make the Shiny equivalent of this: <code>plot(head(cars, nrows))</code></p>
<p>I’ll give you five minutes. That might be way too much time for some of you, but it’ll give us a chance to shake out any technical issues. If you need help, talk to your neighbors, or flag down one of the TAs or myself. If you have extra time, get to know your neighbors a little more.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="exercise-00---code" class="slide level2">
<h2>Exercise 00 - code</h2>
<div class="sourceCode" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb12-2"><a href="#cb12-2"></a></span>
<span id="cb12-3"><a href="#cb12-3"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>(</span>
<span id="cb12-4"><a href="#cb12-4"></a>  <span class="fu">h1</span>(<span class="st">"Example app"</span>),</span>
<span id="cb12-5"><a href="#cb12-5"></a>  <span class="fu">sidebarLayout</span>(</span>
<span id="cb12-6"><a href="#cb12-6"></a>    <span class="fu">sidebarPanel</span>(</span>
<span id="cb12-7"><a href="#cb12-7"></a>      <span class="fu">numericInput</span>(<span class="st">"nrows"</span>, <span class="st">"Number of rows"</span>, <span class="dv">10</span>)</span>
<span id="cb12-8"><a href="#cb12-8"></a>    ),</span>
<span id="cb12-9"><a href="#cb12-9"></a>    <span class="fu">mainPanel</span>(</span>
<span id="cb12-10"><a href="#cb12-10"></a>      <span class="fu">plotOutput</span>(<span class="st">"plot"</span>)</span>
<span id="cb12-11"><a href="#cb12-11"></a>    )</span>
<span id="cb12-12"><a href="#cb12-12"></a>  )</span>
<span id="cb12-13"><a href="#cb12-13"></a>)</span>
<span id="cb12-14"><a href="#cb12-14"></a></span>
<span id="cb12-15"><a href="#cb12-15"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output, session) {</span>
<span id="cb12-16"><a href="#cb12-16"></a>  <span class="co"># Assignment: Plot the first input$nrows columns of a</span></span>
<span id="cb12-17"><a href="#cb12-17"></a>  <span class="co"># data frame of your choosing, using head() and plot()</span></span>
<span id="cb12-18"><a href="#cb12-18"></a>}</span>
<span id="cb12-19"><a href="#cb12-19"></a></span>
<span id="cb12-20"><a href="#cb12-20"></a><span class="fu">shinyApp</span>(ui, server)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="solution---00" class="slide level2">
<h2>Solution - 00</h2>
<div class="sourceCode" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb13-2"><a href="#cb13-2"></a></span>
<span id="cb13-3"><a href="#cb13-3"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>(</span>
<span id="cb13-4"><a href="#cb13-4"></a>  <span class="fu">h1</span>(<span class="st">"Example app"</span>),</span>
<span id="cb13-5"><a href="#cb13-5"></a>  <span class="fu">sidebarLayout</span>(</span>
<span id="cb13-6"><a href="#cb13-6"></a>    <span class="fu">sidebarPanel</span>(</span>
<span id="cb13-7"><a href="#cb13-7"></a>      <span class="fu">numericInput</span>(<span class="st">"nrows"</span>, <span class="st">"Number of rows"</span>, <span class="dv">10</span>)</span>
<span id="cb13-8"><a href="#cb13-8"></a>    ),</span>
<span id="cb13-9"><a href="#cb13-9"></a>    <span class="fu">mainPanel</span>(</span>
<span id="cb13-10"><a href="#cb13-10"></a>      <span class="fu">plotOutput</span>(<span class="st">"plot"</span>)</span>
<span id="cb13-11"><a href="#cb13-11"></a>    )</span>
<span id="cb13-12"><a href="#cb13-12"></a>  )</span>
<span id="cb13-13"><a href="#cb13-13"></a>)</span>
<span id="cb13-14"><a href="#cb13-14"></a></span>
<span id="cb13-15"><a href="#cb13-15"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output, session) {</span>
<span id="cb13-16"><a href="#cb13-16"></a>  output<span class="sc">$</span>plot <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb13-17"><a href="#cb13-17"></a>    <span class="fu">plot</span>(<span class="fu">head</span>(cars, input<span class="sc">$</span>nrows))</span>
<span id="cb13-18"><a href="#cb13-18"></a>  })</span>
<span id="cb13-19"><a href="#cb13-19"></a>}</span>
<span id="cb13-20"><a href="#cb13-20"></a></span>
<span id="cb13-21"><a href="#cb13-21"></a><span class="fu">shinyApp</span>(ui, server)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="exercise-01" class="slide level2">
<h2>Exercise 01</h2>
<p>Open up the file <code>Exercise_01.R</code>.</p>
<p>There’s a new <code>tableOutput("table")</code> in ui.R. Have it show the same data frame that is being plotted, using <code>renderTable</code>.</p>
<p><strong>Make sure that the <code>head()</code> operation isn’t performed more than once for each change to <code>input$nrows</code>.</strong></p>
<p>You have 5 minutes.</p>
</section>
<section id="exercise-01---code" class="slide level2">
<h2>Exercise 01 - code</h2>
<div class="sourceCode" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb14-2"><a href="#cb14-2"></a></span>
<span id="cb14-3"><a href="#cb14-3"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>(</span>
<span id="cb14-4"><a href="#cb14-4"></a>  <span class="fu">h1</span>(<span class="st">"Example app"</span>),</span>
<span id="cb14-5"><a href="#cb14-5"></a>  <span class="fu">sidebarLayout</span>(</span>
<span id="cb14-6"><a href="#cb14-6"></a>    <span class="fu">sidebarPanel</span>(</span>
<span id="cb14-7"><a href="#cb14-7"></a>      <span class="fu">numericInput</span>(<span class="st">"nrows"</span>, <span class="st">"Number of rows"</span>, <span class="dv">10</span>)</span>
<span id="cb14-8"><a href="#cb14-8"></a>    ),</span>
<span id="cb14-9"><a href="#cb14-9"></a>    <span class="fu">mainPanel</span>(</span>
<span id="cb14-10"><a href="#cb14-10"></a>      <span class="fu">plotOutput</span>(<span class="st">"plot"</span>),</span>
<span id="cb14-11"><a href="#cb14-11"></a>      <span class="fu">tableOutput</span>(<span class="st">"table"</span>)</span>
<span id="cb14-12"><a href="#cb14-12"></a>    )</span>
<span id="cb14-13"><a href="#cb14-13"></a>  )</span>
<span id="cb14-14"><a href="#cb14-14"></a>)</span>
<span id="cb14-15"><a href="#cb14-15"></a></span>
<span id="cb14-16"><a href="#cb14-16"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output, session) {</span>
<span id="cb14-17"><a href="#cb14-17"></a>  <span class="co"># Assignment: Factor out the head(cars, input$nrows) so</span></span>
<span id="cb14-18"><a href="#cb14-18"></a>  <span class="co"># that the code isn't duplicated and the operation isn't</span></span>
<span id="cb14-19"><a href="#cb14-19"></a>  <span class="co"># performed twice for each change to input$nrows.</span></span>
<span id="cb14-20"><a href="#cb14-20"></a>  </span>
<span id="cb14-21"><a href="#cb14-21"></a>  output<span class="sc">$</span>plot <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb14-22"><a href="#cb14-22"></a>    <span class="fu">plot</span>(<span class="fu">head</span>(cars, input<span class="sc">$</span>nrows))</span>
<span id="cb14-23"><a href="#cb14-23"></a>  })</span>
<span id="cb14-24"><a href="#cb14-24"></a>  </span>
<span id="cb14-25"><a href="#cb14-25"></a>  output<span class="sc">$</span>table <span class="ot">&lt;-</span> <span class="fu">renderTable</span>({</span>
<span id="cb14-26"><a href="#cb14-26"></a>    <span class="fu">head</span>(cars, input<span class="sc">$</span>nrows)</span>
<span id="cb14-27"><a href="#cb14-27"></a>  })</span>
<span id="cb14-28"><a href="#cb14-28"></a>}</span>
<span id="cb14-29"><a href="#cb14-29"></a></span>
<span id="cb14-30"><a href="#cb14-30"></a><span class="fu">shinyApp</span>(ui, server)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="solution---01" class="slide level2">
<h2>Solution - 01</h2>
<div class="sourceCode" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="cf">function</span>(input, output, session) {</span>
<span id="cb15-2"><a href="#cb15-2"></a>  df <span class="ot">&lt;-</span> <span class="fu">reactive</span>({</span>
<span id="cb15-3"><a href="#cb15-3"></a>    <span class="fu">head</span>(cars, input<span class="sc">$</span>nrows)</span>
<span id="cb15-4"><a href="#cb15-4"></a>  })</span>
<span id="cb15-5"><a href="#cb15-5"></a>  </span>
<span id="cb15-6"><a href="#cb15-6"></a>  output<span class="sc">$</span>plot <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb15-7"><a href="#cb15-7"></a>    <span class="fu">plot</span>(<span class="fu">df</span>())</span>
<span id="cb15-8"><a href="#cb15-8"></a>  })</span>
<span id="cb15-9"><a href="#cb15-9"></a>  </span>
<span id="cb15-10"><a href="#cb15-10"></a>  output<span class="sc">$</span>table <span class="ot">&lt;-</span> <span class="fu">renderTable</span>({</span>
<span id="cb15-11"><a href="#cb15-11"></a>    <span class="fu">df</span>()</span>
<span id="cb15-12"><a href="#cb15-12"></a>  })</span>
<span id="cb15-13"><a href="#cb15-13"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<aside class="notes">
<p>OK, we’re back. Hopefully your code looks something like this.</p>
<p>How many of you ended up with this answer? Anyone come up with something different?</p>
<p>What we don’t want is something like this:</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="anti-solution-1" class="slide level2">
<h2>Anti-solution 1</h2>
<pre><code>function(input, output, session) {
  values &lt;- reactiveValues(df = cars)
  observe({
    values$df &lt;- head(cars, input$nrows)
  })
  
  output$plot &lt;- renderPlot({
    plot(values$df)
  })
  
  output$table &lt;- renderTable({
    values$df
  })
}</code></pre>
</section>
<section id="anti-solution-02" class="slide level2">
<h2>Anti-solution 02</h2>
<pre><code>observe({
  df &lt;- head(cars, input$nrows)
  output$plot &lt;- renderPlot(plot(df))
})</code></pre>
</section>
<section id="anti-solution-03" class="slide level2">
<h2>Anti-solution 03</h2>
<pre><code>function(input, output, session) {
  df &lt;&lt;- cars
  observe({
    df &lt;&lt;- head(cars, input$nrows)
  })
  
  output$plot &lt;- renderPlot({
    plot(df)
  })
  
  output$table &lt;- renderTable({
    df
  })
}</code></pre>
<aside class="notes">
<p>Let’s forget about that last one, since it doesn’t work. What about the previous two? Let’s talk about what they do. The first one uses a reactive expression to store the calculation. The second one creates a reactive values object and uses an observer to keep the value up-to-date. Who prefers the first approach? Who prefers the second?</p>
<p>So we mostly agree that the first approach is superior. But why? It might feel like I’m just setting up strawmen, but I see this kind of code all the time on the shiny-discuss mailing list. It seems obvious when we lay it bare with a minimal example like this, but in the context of a more complicated app, it can be much trickier.</p>
<p>We shouldn’t take the second approach—but <em>why</em> shouldn’t we take it? What’s the first-principles reason to avoid this kind of code? We need some first-principles to build from so we can confidently answer these questions. You should be able to confidently answer these questions by the end of the tutorial.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<aside class="notes">
<p>This pattern of putting renderPlot inside of an observe, usually means the author has a fundamental misconception of what it means to assign a render code block to an output slot.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="section-1" class="slide level2">
<h2></h2>
<p><code>output$plot1 &lt;- renderPlot(...)</code></p>
<ul>
<li><strong>DOESN’T mean:</strong> “Go update the output <code>"plot1"</code> with the result of this code.”</li>
<li><strong>DOES mean:</strong> “This code is the <em>recipe</em> that should be used to update the output <code>"plot1"</code>.”</li>
</ul>
<aside class="notes">
<p>Historically, we’ve asked you to take it on faith that whenever <code>input$nrows</code> changes, any dependent outputs, reactive expressions, and observers will do the right thing. But how does Shiny know how the code is related? How does it know which outputs depend on which inputs, reactives, etc.?</p>
<p>There are really two possibilities: <em>static</em> analysis, where we’d examine your code, looking for reactive-looking things; and <em>runtime</em> analysis, where we’d execute your code and see what happens.</p>
<p>We do the latter. Shiny just executes your code and sees what happens. It eavesdrops to see what reactive values (like <code>input</code>) or reactive expressions your output reads, and whatever it reads is considered a “dependency”. Any changes to one of those dependencies means the output is considered out-of-date, or “invalidated”, and might need to be re-executed.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="reactive-expressions" class="slide level2">
<h2>Reactive expressions</h2>
<div class="fragment">
<p><strong>Expressions</strong> that are <strong>reactive</strong> <span class="fragment">(obviously)</span></p>
</div>
<ul>
<li><strong>Expression:</strong> Code that <em>produces a value</em></li>
</ul>
<ul>
<li><strong>Reactive:</strong> <em>Detects changes</em> in anything reactive it reads</li>
</ul>
</section>
<section id="section-2" class="slide level2">
<h2></h2>
<div class="sourceCode" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="cf">function</span>(input, output, session) {</span>
<span id="cb19-2"><a href="#cb19-2"></a>  <span class="co"># When input$min_size or input$max_size change, large_diamonds</span></span>
<span id="cb19-3"><a href="#cb19-3"></a>  <span class="co"># will be notified about it.</span></span>
<span id="cb19-4"><a href="#cb19-4"></a>  large_diamonds <span class="ot">&lt;-</span> <span class="fu">reactive</span>({</span>
<span id="cb19-5"><a href="#cb19-5"></a>    diamonds <span class="sc">%&gt;%</span></span>
<span id="cb19-6"><a href="#cb19-6"></a>      <span class="fu">filter</span>(carat <span class="sc">&gt;=</span> input<span class="sc">$</span>min_size) <span class="sc">%&gt;%</span></span>
<span id="cb19-7"><a href="#cb19-7"></a>      <span class="fu">filter</span>(carat <span class="sc">&lt;</span> input<span class="sc">$</span>max_size)</span>
<span id="cb19-8"><a href="#cb19-8"></a>  })</span>
<span id="cb19-9"><a href="#cb19-9"></a>  </span>
<span id="cb19-10"><a href="#cb19-10"></a>  <span class="co"># If that happens, large_diamonds will notify output$table.</span></span>
<span id="cb19-11"><a href="#cb19-11"></a>  output<span class="sc">$</span>table <span class="ot">&lt;-</span> <span class="fu">renderTable</span>({</span>
<span id="cb19-12"><a href="#cb19-12"></a>    <span class="fu">large_diamonds</span>() <span class="sc">%&gt;%</span> <span class="fu">select</span>(carat, price)</span>
<span id="cb19-13"><a href="#cb19-13"></a>  })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="section-3" class="slide level2">
<h2></h2>
<div class="sourceCode" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>  ... continued ...</span>
<span id="cb20-2"><a href="#cb20-2"></a>  <span class="co"># Reactive expressions can use other reactive expressions.</span></span>
<span id="cb20-3"><a href="#cb20-3"></a>  mean_price <span class="ot">&lt;-</span> <span class="fu">reactive</span>({</span>
<span id="cb20-4"><a href="#cb20-4"></a>    <span class="fu">mean</span>(<span class="fu">large_diamonds</span>()<span class="sc">$</span>price)</span>
<span id="cb20-5"><a href="#cb20-5"></a>  })</span>
<span id="cb20-6"><a href="#cb20-6"></a>  </span>
<span id="cb20-7"><a href="#cb20-7"></a>  <span class="co"># large_diamonds and mean_price will both notify output$message</span></span>
<span id="cb20-8"><a href="#cb20-8"></a>  <span class="co"># of changes they detect.</span></span>
<span id="cb20-9"><a href="#cb20-9"></a>  output<span class="sc">$</span>message <span class="ot">&lt;-</span> <span class="fu">renderText</span>({</span>
<span id="cb20-10"><a href="#cb20-10"></a>    <span class="fu">paste0</span>(<span class="fu">nrow</span>(<span class="fu">large_diamonds</span>()), <span class="st">" diamonds in that range, "</span>,</span>
<span id="cb20-11"><a href="#cb20-11"></a>      <span class="st">"with an average price of $"</span>, <span class="fu">mean_price</span>())</span>
<span id="cb20-12"><a href="#cb20-12"></a>  })</span>
<span id="cb20-13"><a href="#cb20-13"></a><span class="er">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="section-4" class="slide level2">
<h2></h2>
<div class="sourceCode" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="cf">function</span>(input, output, session) {</span>
<span id="cb21-2"><a href="#cb21-2"></a>  </span>
<span id="cb21-3"><a href="#cb21-3"></a><span class="co"># This DOESN'T work.</span></span>
<span id="cb21-4"><a href="#cb21-4"></a>large_diamonds <span class="ot">&lt;-</span> diamonds <span class="sc">%&gt;%</span></span>
<span id="cb21-5"><a href="#cb21-5"></a>  <span class="fu">filter</span>(carat <span class="sc">&gt;=</span> input<span class="sc">$</span>min_size) <span class="sc">%&gt;%</span></span>
<span id="cb21-6"><a href="#cb21-6"></a>  <span class="fu">filter</span>(carat <span class="sc">&lt;</span> input<span class="sc">$</span>max_size)</span>
<span id="cb21-7"><a href="#cb21-7"></a></span>
<span id="cb21-8"><a href="#cb21-8"></a>output<span class="sc">$</span>table <span class="ot">&lt;-</span> <span class="fu">renderTable</span>({</span>
<span id="cb21-9"><a href="#cb21-9"></a>  large_diamonds <span class="sc">%&gt;%</span> <span class="fu">select</span>(carat, price)</span>
<span id="cb21-10"><a href="#cb21-10"></a>})</span>
<span id="cb21-11"><a href="#cb21-11"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><code>large_diamonds</code> would only be calculated once, as the session starts (i.e.&nbsp;as the page first loads in a browser).</p>
</section>
<section id="exercise-02---code" class="slide level2">
<h2>Exercise 02 - code</h2>
<div class="sourceCode" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb22-2"><a href="#cb22-2"></a></span>
<span id="cb22-3"><a href="#cb22-3"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>(</span>
<span id="cb22-4"><a href="#cb22-4"></a>  <span class="fu">sidebarLayout</span>(</span>
<span id="cb22-5"><a href="#cb22-5"></a>    <span class="fu">sidebarPanel</span>(</span>
<span id="cb22-6"><a href="#cb22-6"></a>      <span class="fu">selectInput</span>(<span class="st">"xcol"</span>, <span class="st">"X variable"</span>, <span class="fu">names</span>(iris)),</span>
<span id="cb22-7"><a href="#cb22-7"></a>      <span class="fu">selectInput</span>(<span class="st">"ycol"</span>, <span class="st">"Y variable"</span>, <span class="fu">names</span>(iris), <span class="fu">names</span>(iris)[<span class="dv">2</span>]),</span>
<span id="cb22-8"><a href="#cb22-8"></a>      <span class="fu">numericInput</span>(<span class="st">"rows"</span>, <span class="st">"Rows to show"</span>, <span class="dv">10</span>)</span>
<span id="cb22-9"><a href="#cb22-9"></a>    ),</span>
<span id="cb22-10"><a href="#cb22-10"></a>    <span class="fu">mainPanel</span>(</span>
<span id="cb22-11"><a href="#cb22-11"></a>      <span class="fu">tabsetPanel</span>(</span>
<span id="cb22-12"><a href="#cb22-12"></a>        <span class="fu">tabPanel</span>(<span class="st">"Data"</span>, <span class="fu">br</span>(),</span>
<span id="cb22-13"><a href="#cb22-13"></a>          <span class="fu">tableOutput</span>(<span class="st">"table"</span>)</span>
<span id="cb22-14"><a href="#cb22-14"></a>        ),</span>
<span id="cb22-15"><a href="#cb22-15"></a>        <span class="fu">tabPanel</span>(<span class="st">"Summary"</span>, <span class="fu">br</span>(),</span>
<span id="cb22-16"><a href="#cb22-16"></a>          <span class="fu">verbatimTextOutput</span>(<span class="st">"dataInfo"</span>),</span>
<span id="cb22-17"><a href="#cb22-17"></a>          <span class="fu">verbatimTextOutput</span>(<span class="st">"modelInfo"</span>)</span>
<span id="cb22-18"><a href="#cb22-18"></a>        ),</span>
<span id="cb22-19"><a href="#cb22-19"></a>        <span class="fu">tabPanel</span>(<span class="st">"Plot"</span>, <span class="fu">br</span>(),</span>
<span id="cb22-20"><a href="#cb22-20"></a>          <span class="fu">plotOutput</span>(<span class="st">"plot"</span>)</span>
<span id="cb22-21"><a href="#cb22-21"></a>        )</span>
<span id="cb22-22"><a href="#cb22-22"></a>      )</span>
<span id="cb22-23"><a href="#cb22-23"></a>    )</span>
<span id="cb22-24"><a href="#cb22-24"></a>  )</span>
<span id="cb22-25"><a href="#cb22-25"></a>)</span>
<span id="cb22-26"><a href="#cb22-26"></a></span>
<span id="cb22-27"><a href="#cb22-27"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output, session) {</span>
<span id="cb22-28"><a href="#cb22-28"></a>  <span class="co"># Assignment: Remove duplication of `selected` and `model`</span></span>
<span id="cb22-29"><a href="#cb22-29"></a>  <span class="co"># code/calculations.</span></span>
<span id="cb22-30"><a href="#cb22-30"></a>  </span>
<span id="cb22-31"><a href="#cb22-31"></a>  output<span class="sc">$</span>plot <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb22-32"><a href="#cb22-32"></a>    </span>
<span id="cb22-33"><a href="#cb22-33"></a>    selected <span class="ot">&lt;-</span> iris[, <span class="fu">c</span>(input<span class="sc">$</span>xcol, input<span class="sc">$</span>ycol)]</span>
<span id="cb22-34"><a href="#cb22-34"></a>    model <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">paste</span>(input<span class="sc">$</span>ycol, <span class="st">"~"</span>, input<span class="sc">$</span>xcol), selected)</span>
<span id="cb22-35"><a href="#cb22-35"></a>    </span>
<span id="cb22-36"><a href="#cb22-36"></a>    <span class="fu">plot</span>(selected)</span>
<span id="cb22-37"><a href="#cb22-37"></a>    <span class="fu">abline</span>(model)</span>
<span id="cb22-38"><a href="#cb22-38"></a>  })</span>
<span id="cb22-39"><a href="#cb22-39"></a>  </span>
<span id="cb22-40"><a href="#cb22-40"></a>  output<span class="sc">$</span>modelInfo <span class="ot">&lt;-</span> <span class="fu">renderPrint</span>({</span>
<span id="cb22-41"><a href="#cb22-41"></a></span>
<span id="cb22-42"><a href="#cb22-42"></a>    selected <span class="ot">&lt;-</span> iris[, <span class="fu">c</span>(input<span class="sc">$</span>xcol, input<span class="sc">$</span>ycol)]</span>
<span id="cb22-43"><a href="#cb22-43"></a>    model <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">paste</span>(input<span class="sc">$</span>ycol, <span class="st">"~"</span>, input<span class="sc">$</span>xcol), selected)</span>
<span id="cb22-44"><a href="#cb22-44"></a>    </span>
<span id="cb22-45"><a href="#cb22-45"></a>    <span class="fu">summary</span>(model)</span>
<span id="cb22-46"><a href="#cb22-46"></a>  })</span>
<span id="cb22-47"><a href="#cb22-47"></a>  </span>
<span id="cb22-48"><a href="#cb22-48"></a>  output<span class="sc">$</span>dataInfo <span class="ot">&lt;-</span> <span class="fu">renderPrint</span>({</span>
<span id="cb22-49"><a href="#cb22-49"></a></span>
<span id="cb22-50"><a href="#cb22-50"></a>    selected <span class="ot">&lt;-</span> iris[, <span class="fu">c</span>(input<span class="sc">$</span>xcol, input<span class="sc">$</span>ycol)]</span>
<span id="cb22-51"><a href="#cb22-51"></a></span>
<span id="cb22-52"><a href="#cb22-52"></a>    <span class="fu">summary</span>(selected)</span>
<span id="cb22-53"><a href="#cb22-53"></a>  })</span>
<span id="cb22-54"><a href="#cb22-54"></a>  </span>
<span id="cb22-55"><a href="#cb22-55"></a>  output<span class="sc">$</span>table <span class="ot">&lt;-</span> <span class="fu">renderTable</span>({</span>
<span id="cb22-56"><a href="#cb22-56"></a>    </span>
<span id="cb22-57"><a href="#cb22-57"></a>    selected <span class="ot">&lt;-</span> iris[, <span class="fu">c</span>(input<span class="sc">$</span>xcol, input<span class="sc">$</span>ycol)]</span>
<span id="cb22-58"><a href="#cb22-58"></a>    </span>
<span id="cb22-59"><a href="#cb22-59"></a>    <span class="fu">head</span>(selected, input<span class="sc">$</span>rows)</span>
<span id="cb22-60"><a href="#cb22-60"></a>  })</span>
<span id="cb22-61"><a href="#cb22-61"></a>}</span>
<span id="cb22-62"><a href="#cb22-62"></a></span>
<span id="cb22-63"><a href="#cb22-63"></a><span class="fu">shinyApp</span>(ui, server)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="solution-02" class="slide level2">
<h2>Solution 02</h2>
<div class="sourceCode" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb23-2"><a href="#cb23-2"></a></span>
<span id="cb23-3"><a href="#cb23-3"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>(</span>
<span id="cb23-4"><a href="#cb23-4"></a>  <span class="fu">sidebarLayout</span>(</span>
<span id="cb23-5"><a href="#cb23-5"></a>    <span class="fu">sidebarPanel</span>(</span>
<span id="cb23-6"><a href="#cb23-6"></a>      <span class="fu">selectInput</span>(<span class="st">"xcol"</span>, <span class="st">"X variable"</span>, <span class="fu">names</span>(iris)),</span>
<span id="cb23-7"><a href="#cb23-7"></a>      <span class="fu">selectInput</span>(<span class="st">"ycol"</span>, <span class="st">"Y variable"</span>, <span class="fu">names</span>(iris), <span class="fu">names</span>(iris)[<span class="dv">2</span>]),</span>
<span id="cb23-8"><a href="#cb23-8"></a>      <span class="fu">numericInput</span>(<span class="st">"rows"</span>, <span class="st">"Rows to show"</span>, <span class="dv">10</span>)</span>
<span id="cb23-9"><a href="#cb23-9"></a>    ),</span>
<span id="cb23-10"><a href="#cb23-10"></a>    <span class="fu">mainPanel</span>(</span>
<span id="cb23-11"><a href="#cb23-11"></a>      <span class="fu">tabsetPanel</span>(</span>
<span id="cb23-12"><a href="#cb23-12"></a>        <span class="fu">tabPanel</span>(<span class="st">"Data"</span>, <span class="fu">br</span>(),</span>
<span id="cb23-13"><a href="#cb23-13"></a>          <span class="fu">tableOutput</span>(<span class="st">"table"</span>)</span>
<span id="cb23-14"><a href="#cb23-14"></a>        ),</span>
<span id="cb23-15"><a href="#cb23-15"></a>        <span class="fu">tabPanel</span>(<span class="st">"Summary"</span>, <span class="fu">br</span>(),</span>
<span id="cb23-16"><a href="#cb23-16"></a>          <span class="fu">verbatimTextOutput</span>(<span class="st">"dataInfo"</span>),</span>
<span id="cb23-17"><a href="#cb23-17"></a>          <span class="fu">verbatimTextOutput</span>(<span class="st">"modelInfo"</span>)</span>
<span id="cb23-18"><a href="#cb23-18"></a>        ),</span>
<span id="cb23-19"><a href="#cb23-19"></a>        <span class="fu">tabPanel</span>(<span class="st">"Plot"</span>, <span class="fu">br</span>(),</span>
<span id="cb23-20"><a href="#cb23-20"></a>          <span class="fu">plotOutput</span>(<span class="st">"plot"</span>)</span>
<span id="cb23-21"><a href="#cb23-21"></a>        )</span>
<span id="cb23-22"><a href="#cb23-22"></a>      )</span>
<span id="cb23-23"><a href="#cb23-23"></a>    )</span>
<span id="cb23-24"><a href="#cb23-24"></a>  )</span>
<span id="cb23-25"><a href="#cb23-25"></a>)</span>
<span id="cb23-26"><a href="#cb23-26"></a></span>
<span id="cb23-27"><a href="#cb23-27"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output, session) {</span>
<span id="cb23-28"><a href="#cb23-28"></a>  </span>
<span id="cb23-29"><a href="#cb23-29"></a>  <span class="co"># Introduce reactive expression for each calculated value</span></span>
<span id="cb23-30"><a href="#cb23-30"></a></span>
<span id="cb23-31"><a href="#cb23-31"></a>  selected <span class="ot">&lt;-</span> <span class="fu">reactive</span>({</span>
<span id="cb23-32"><a href="#cb23-32"></a>    iris[, <span class="fu">c</span>(input<span class="sc">$</span>xcol, input<span class="sc">$</span>ycol)]</span>
<span id="cb23-33"><a href="#cb23-33"></a>  })</span>
<span id="cb23-34"><a href="#cb23-34"></a>  </span>
<span id="cb23-35"><a href="#cb23-35"></a>  model <span class="ot">&lt;-</span> <span class="fu">reactive</span>({</span>
<span id="cb23-36"><a href="#cb23-36"></a>    <span class="fu">lm</span>(<span class="fu">paste</span>(input<span class="sc">$</span>ycol, <span class="st">"~"</span>, input<span class="sc">$</span>xcol), <span class="fu">selected</span>())</span>
<span id="cb23-37"><a href="#cb23-37"></a>  })</span>
<span id="cb23-38"><a href="#cb23-38"></a>  </span>
<span id="cb23-39"><a href="#cb23-39"></a>  <span class="co"># And now the outputs can just use the reactive expressions</span></span>
<span id="cb23-40"><a href="#cb23-40"></a>    </span>
<span id="cb23-41"><a href="#cb23-41"></a>  output<span class="sc">$</span>plot <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb23-42"><a href="#cb23-42"></a>    </span>
<span id="cb23-43"><a href="#cb23-43"></a>    <span class="fu">plot</span>(<span class="fu">selected</span>())</span>
<span id="cb23-44"><a href="#cb23-44"></a>    <span class="fu">abline</span>(<span class="fu">model</span>())</span>
<span id="cb23-45"><a href="#cb23-45"></a>  })</span>
<span id="cb23-46"><a href="#cb23-46"></a>  </span>
<span id="cb23-47"><a href="#cb23-47"></a>  output<span class="sc">$</span>modelInfo <span class="ot">&lt;-</span> <span class="fu">renderPrint</span>({</span>
<span id="cb23-48"><a href="#cb23-48"></a></span>
<span id="cb23-49"><a href="#cb23-49"></a>    <span class="fu">summary</span>(<span class="fu">model</span>())</span>
<span id="cb23-50"><a href="#cb23-50"></a>  })</span>
<span id="cb23-51"><a href="#cb23-51"></a>  </span>
<span id="cb23-52"><a href="#cb23-52"></a>  output<span class="sc">$</span>dataInfo <span class="ot">&lt;-</span> <span class="fu">renderPrint</span>({</span>
<span id="cb23-53"><a href="#cb23-53"></a></span>
<span id="cb23-54"><a href="#cb23-54"></a>    <span class="fu">summary</span>(<span class="fu">selected</span>())</span>
<span id="cb23-55"><a href="#cb23-55"></a>  })</span>
<span id="cb23-56"><a href="#cb23-56"></a>  </span>
<span id="cb23-57"><a href="#cb23-57"></a>  output<span class="sc">$</span>table <span class="ot">&lt;-</span> <span class="fu">renderTable</span>({</span>
<span id="cb23-58"><a href="#cb23-58"></a>    </span>
<span id="cb23-59"><a href="#cb23-59"></a>    <span class="fu">head</span>(<span class="fu">selected</span>(), input<span class="sc">$</span>rows)</span>
<span id="cb23-60"><a href="#cb23-60"></a>  })</span>
<span id="cb23-61"><a href="#cb23-61"></a>}</span>
<span id="cb23-62"><a href="#cb23-62"></a></span>
<span id="cb23-63"><a href="#cb23-63"></a><span class="fu">shinyApp</span>(ui, server)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="observers" class="slide level2">
<h2>Observers</h2>
<p>Observers are blocks of code that <strong>perform actions</strong>.</p>
<p>They’re executed in response to changing reactive values/expressions.</p>
<p>They don’t return a value.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="fu">observe</span>({</span>
<span id="cb24-2"><a href="#cb24-2"></a>  <span class="fu">cat</span>(<span class="st">"The value of input$x is now "</span>, input<span class="sc">$</span>x, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb24-3"><a href="#cb24-3"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="observers-come-in-two-flavors" class="slide level2">
<h2>Observers come in two flavors</h2>
<ol type="1">
<li class="fragment"><strong>Implicit:</strong> Depend on <em>all</em> reactive values/expressions encountered during execution.<br>
<code>observe({...})</code><br>
&nbsp;</li>
<li class="fragment"><strong>Explicit:</strong> Just depend on <em>specific</em> reactive value/expression; ignore all others. (Also known as “event handler”.)<br>
<code>observeEvent(eventExpr, {...})</code></li>
</ol>
</section>
<section id="section-5" class="slide level2">
<h2></h2>
<div class="sourceCode" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="cf">function</span>(input, output, session) {</span>
<span id="cb25-2"><a href="#cb25-2"></a>  <span class="co"># Executes immediately, and repeats whenever input$x changes.</span></span>
<span id="cb25-3"><a href="#cb25-3"></a>  <span class="fu">observe</span>({</span>
<span id="cb25-4"><a href="#cb25-4"></a>    <span class="fu">cat</span>(<span class="st">"The value of input$x is now "</span>, input<span class="sc">$</span>x, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb25-5"><a href="#cb25-5"></a>  })</span>
<span id="cb25-6"><a href="#cb25-6"></a>  </span>
<span id="cb25-7"><a href="#cb25-7"></a>  <span class="co"># Only executes when input$upload_button is pushed. Any reactive</span></span>
<span id="cb25-8"><a href="#cb25-8"></a>  <span class="co"># values/expressions encountered in the code block are treated</span></span>
<span id="cb25-9"><a href="#cb25-9"></a>  <span class="co"># as non-reactive values/expressions.</span></span>
<span id="cb25-10"><a href="#cb25-10"></a>  <span class="fu">observeEvent</span>(input<span class="sc">$</span>upload_button, {</span>
<span id="cb25-11"><a href="#cb25-11"></a>    httr<span class="sc">::</span><span class="fu">POST</span>(server_url, jsonlite<span class="sc">::</span><span class="fu">toJSON</span>(<span class="fu">dataset</span>()))</span>
<span id="cb25-12"><a href="#cb25-12"></a>  })</span>
<span id="cb25-13"><a href="#cb25-13"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="exercise-03" class="slide level2">
<h2>Exercise 03</h2>
<p>Open <code>Exercise_03.R</code>.</p>
<p>Add server logic so that when the <code>input$save</code> button is pressed, the data is saved to a CSV file called <code>"data.csv"</code> in the current directory.</p>
<p>You have 5 minutes!</p>
</section>
<section id="exercise-3---code" class="slide level2">
<h2>Exercise 3 - code</h2>
<div class="sourceCode" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb26-2"><a href="#cb26-2"></a></span>
<span id="cb26-3"><a href="#cb26-3"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>(</span>
<span id="cb26-4"><a href="#cb26-4"></a>  <span class="fu">h1</span>(<span class="st">"Example app"</span>),</span>
<span id="cb26-5"><a href="#cb26-5"></a>  <span class="fu">sidebarLayout</span>(</span>
<span id="cb26-6"><a href="#cb26-6"></a>    <span class="fu">sidebarPanel</span>(</span>
<span id="cb26-7"><a href="#cb26-7"></a>      <span class="fu">numericInput</span>(<span class="st">"nrows"</span>, <span class="st">"Number of rows"</span>, <span class="dv">10</span>),</span>
<span id="cb26-8"><a href="#cb26-8"></a>      <span class="fu">actionButton</span>(<span class="st">"save"</span>, <span class="st">"Save"</span>)</span>
<span id="cb26-9"><a href="#cb26-9"></a>    ),</span>
<span id="cb26-10"><a href="#cb26-10"></a>    <span class="fu">mainPanel</span>(</span>
<span id="cb26-11"><a href="#cb26-11"></a>      <span class="fu">plotOutput</span>(<span class="st">"plot"</span>),</span>
<span id="cb26-12"><a href="#cb26-12"></a>      <span class="fu">tableOutput</span>(<span class="st">"table"</span>)</span>
<span id="cb26-13"><a href="#cb26-13"></a>    )</span>
<span id="cb26-14"><a href="#cb26-14"></a>  )</span>
<span id="cb26-15"><a href="#cb26-15"></a>)</span>
<span id="cb26-16"><a href="#cb26-16"></a></span>
<span id="cb26-17"><a href="#cb26-17"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output, session) {</span>
<span id="cb26-18"><a href="#cb26-18"></a>  df <span class="ot">&lt;-</span> <span class="fu">reactive</span>({</span>
<span id="cb26-19"><a href="#cb26-19"></a>    <span class="fu">head</span>(cars, input<span class="sc">$</span>nrows)</span>
<span id="cb26-20"><a href="#cb26-20"></a>  })</span>
<span id="cb26-21"><a href="#cb26-21"></a>  </span>
<span id="cb26-22"><a href="#cb26-22"></a>  output<span class="sc">$</span>plot <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb26-23"><a href="#cb26-23"></a>    <span class="fu">plot</span>(<span class="fu">df</span>())</span>
<span id="cb26-24"><a href="#cb26-24"></a>  })</span>
<span id="cb26-25"><a href="#cb26-25"></a>  </span>
<span id="cb26-26"><a href="#cb26-26"></a>  output<span class="sc">$</span>table <span class="ot">&lt;-</span> <span class="fu">renderTable</span>({</span>
<span id="cb26-27"><a href="#cb26-27"></a>    <span class="fu">df</span>()</span>
<span id="cb26-28"><a href="#cb26-28"></a>  })</span>
<span id="cb26-29"><a href="#cb26-29"></a>  </span>
<span id="cb26-30"><a href="#cb26-30"></a>  <span class="co"># Assignment: Add logic so that when the "save" button</span></span>
<span id="cb26-31"><a href="#cb26-31"></a>  <span class="co"># is pressed, the data is saved to a CSV file called</span></span>
<span id="cb26-32"><a href="#cb26-32"></a>  <span class="co"># "data.csv" in the current directory.</span></span>
<span id="cb26-33"><a href="#cb26-33"></a>}</span>
<span id="cb26-34"><a href="#cb26-34"></a></span>
<span id="cb26-35"><a href="#cb26-35"></a><span class="fu">shinyApp</span>(ui, server)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="solution" class="slide level2">
<h2>Solution</h2>
<div class="sourceCode" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="co"># Use observeEvent to tell Shiny what action to take</span></span>
<span id="cb27-2"><a href="#cb27-2"></a><span class="co"># when input$save is clicked.</span></span>
<span id="cb27-3"><a href="#cb27-3"></a><span class="fu">observeEvent</span>(input<span class="sc">$</span>save, {</span>
<span id="cb27-4"><a href="#cb27-4"></a>  <span class="fu">write.csv</span>(<span class="fu">df</span>(), <span class="st">"data.csv"</span>)</span>
<span id="cb27-5"><a href="#cb27-5"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="reactive-expressions-vs.-observers" class="slide level2">
<h2>Reactive expressions vs.&nbsp;observers</h2>
</section>
<section id="reactive" class="slide level2">
<h2><code>reactive()</code></h2>
<ol type="1">
<li class="fragment">It <strong>can be called</strong> and <strong>returns a value</strong>, like a function. Either the last expression, or <code>return()</code>.</li>
<li class="fragment">It’s <strong>lazy</strong>. It doesn’t execute its code until somebody calls it (even if its reactive dependencies have changed). Also like a function.</li>
<li class="fragment">It’s <strong>cached</strong>. The first time it’s called, it executes the code and saves the resulting value. Subsequent calls can skip the execution and just return the value.</li>
<li class="fragment">It’s <strong>reactive</strong>. It is notified when its dependencies change. When that happens, it clears its cache and notifies it dependents.</li>
</ol>
</section>
<section id="section-6" class="slide level2">
<h2></h2>
<div class="sourceCode" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>r1 <span class="ot">&lt;-</span> <span class="cf">function</span>() { <span class="fu">runif</span>(<span class="dv">1</span>) }</span>
<span id="cb28-2"><a href="#cb28-2"></a><span class="fu">r1</span>()</span>
<span id="cb28-3"><a href="#cb28-3"></a><span class="co"># [1] 0.8403573</span></span>
<span id="cb28-4"><a href="#cb28-4"></a><span class="fu">r1</span>()</span>
<span id="cb28-5"><a href="#cb28-5"></a><span class="co"># [1] 0.4590713</span></span>
<span id="cb28-6"><a href="#cb28-6"></a><span class="fu">r1</span>()</span>
<span id="cb28-7"><a href="#cb28-7"></a><span class="co"># [1] 0.9816089</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="fragment">
<div class="sourceCode" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">reactive</span>({ <span class="fu">runif</span>(<span class="dv">1</span>) })</span>
<span id="cb29-2"><a href="#cb29-2"></a><span class="fu">r2</span>()</span>
<span id="cb29-3"><a href="#cb29-3"></a><span class="co"># [1] 0.5327107</span></span>
<span id="cb29-4"><a href="#cb29-4"></a><span class="fu">r2</span>()</span>
<span id="cb29-5"><a href="#cb29-5"></a><span class="co"># [1] 0.5327107</span></span>
<span id="cb29-6"><a href="#cb29-6"></a><span class="fu">r2</span>()</span>
<span id="cb29-7"><a href="#cb29-7"></a><span class="co"># [1] 0.5327107</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-7" class="slide level2">
<h2></h2>
<p>The fact that reactive expressions are <strong>lazy</strong> and <strong>cached</strong>, is critical.</p>
<div class="fragment">
<p>It’s <strong>hard to reason about</strong> when reactive expressions will execute their code—or whether they will be executed at all.</p>
</div>
<div class="fragment">
<p>All Shiny guarantees is that <strong>when you ask a reactive expression for an answer, you get an up-to-date one</strong>.</p>
</div>
</section>
<section id="section-8" class="slide level2">
<h2></h2>
<div class="sourceCode" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="cf">function</span>(input, output, session) {</span>
<span id="cb30-2"><a href="#cb30-2"></a>  <span class="fu">reactive</span>({</span>
<span id="cb30-3"><a href="#cb30-3"></a>    <span class="co"># This code will never execute!</span></span>
<span id="cb30-4"><a href="#cb30-4"></a>    <span class="fu">cat</span>(<span class="st">"The value of input$x is now "</span>, input<span class="sc">$</span>x, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb30-5"><a href="#cb30-5"></a>  })</span>
<span id="cb30-6"><a href="#cb30-6"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="observe-observeevent" class="slide level2">
<h2><code>observe()</code> / <code>observeEvent()</code></h2>
<ol type="1">
<li class="fragment">It <strong>can’t be called</strong> and <strong>doesn’t return a value</strong>. The value of the last expression will be thrown away, as will values passed to <code>return()</code>.</li>
<li class="fragment">It’s <strong>eager</strong>. When its dependencies change, it executes right away.</li>
<li class="fragment">(Since it can’t be called and doesn’t have a return value, there’s no notion of caching that applies here.)</li>
<li class="fragment">It’s <strong>reactive</strong>. It is notified when its dependencies change, and when that happens it executes (not right at that instant, but ASAP).</li>
</ol>
</section>
<section id="section-9" class="slide level2">
<h2></h2>
<table>
<thead>
<tr class="header">
<th>reactive()</th>
<th>observe()</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Callable</td>
<td>Not callable</td>
</tr>
<tr class="even">
<td>Returns a value</td>
<td>No return value</td>
</tr>
<tr class="odd">
<td>Lazy</td>
<td>Eager</td>
</tr>
<tr class="even">
<td>Cached</td>
<td>N/A</td>
</tr>
</tbody>
</table>
<aside class="notes">
<p>Don’t worry, there won’t be a quiz on this. All of this is to point the way towards the two things you <em>do</em> need to remember.</p>
<p>This next slide is the reason I wanted to have this conference in the first place.</p>
<p>Are you ready?</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="section-10" class="slide level2">
<h2></h2>
<ul>
<li class="fragment"><p><code>reactive()</code> is for <em>calculating values, without side effects</em>.</p></li>
<li class="fragment"><p><code>observe()</code> is for <em>performing actions, with side effects</em>.</p></li>
</ul>
<aside class="notes">
<p>This is what each of these is good for. Do not use an <code>observe</code> when calculating a value, and especially don’t use <code>reactive</code> for performing actions with side effects.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="section-11" class="slide level2">
<h2></h2>
<p>A <strong>calculation</strong> is a block of code where you don’t care about whether the code actually executes—you just want the answer. Safe for caching. <strong>Use <code>reactive()</code>.</strong></p>
<p>An <strong>action</strong> is where you care very much that the code executes, and there is no answer (return value), only side effects. <strong>Use <code>observe()</code>/<code>observeEvent()</code>.</strong></p>
<div class="fragment">
<p>(What if you want both an answer AND you want the code to execute? Refactor into two code chunks–separate the calculation from the action.)</p>
</div>
</section>
<section id="section-12" class="slide level2">
<h2></h2>
<table>
<thead>
<tr class="header">
<th></th>
<th>reactive()</th>
<th>observe()</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Purpose</td>
<td>Calculations</td>
<td>Actions</td>
</tr>
<tr class="even">
<td>Side effects</td>
<td>Forbidden</td>
<td>Allowed</td>
</tr>
</tbody>
</table>
</section>
<section id="an-easy-way-to-remember" class="slide level2">
<h2>An easy way to remember</h2>
<div class="fragment">
<p>Keep your side effects<br>
Outside of your reactives<br>
Or I will kill you</p>
<p><em>—Joe Cheng</em></p>
</div>
</section>
<section id="reactive-values" class="slide level2">
<h2>Reactive values</h2>
<p>A <code>reactiveValues</code> object is like an environment object or a named list: it stores name/value pairs. You get and set values using <code>$</code> or <code>[[name]]</code>.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>rv <span class="ot">&lt;-</span> <span class="fu">reactiveValues</span>(<span class="at">a =</span> <span class="dv">10</span>)</span>
<span id="cb31-2"><a href="#cb31-2"></a>rv<span class="sc">$</span>a</span>
<span id="cb31-3"><a href="#cb31-3"></a><span class="co"># [1] 10</span></span>
<span id="cb31-4"><a href="#cb31-4"></a>rv<span class="sc">$</span>a <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb31-5"><a href="#cb31-5"></a>rv[[<span class="st">"a"</span>]]</span>
<span id="cb31-6"><a href="#cb31-6"></a><span class="co"># [1] 20</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><code>input</code> is one (read-only) example.</p>
</section>
<section id="exercise-4" class="slide level2">
<h2>Exercise 4</h2>
<p>Open file <code>Exercise_04.R</code>.</p>
<p>Modify the server function so that when the “rnorm” button is clicked, the plot shows a new batch of <code>rnorm(100)</code> values. When “runif” button is clicked, the plot should show a new batch of <code>runif(100)</code>.</p>
<p>You have 15 minutes this time.</p>
</section>
<section id="exercise-04---code" class="slide level2">
<h2>Exercise 04 - code</h2>
<div class="sourceCode" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb32-2"><a href="#cb32-2"></a></span>
<span id="cb32-3"><a href="#cb32-3"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>(</span>
<span id="cb32-4"><a href="#cb32-4"></a>  <span class="fu">h1</span>(<span class="st">"Example app 4"</span>),</span>
<span id="cb32-5"><a href="#cb32-5"></a>  <span class="fu">sidebarLayout</span>(</span>
<span id="cb32-6"><a href="#cb32-6"></a>    <span class="fu">sidebarPanel</span>(</span>
<span id="cb32-7"><a href="#cb32-7"></a>      <span class="fu">actionButton</span>(<span class="st">"rnorm"</span>, <span class="st">"Normal"</span>),</span>
<span id="cb32-8"><a href="#cb32-8"></a>      <span class="fu">actionButton</span>(<span class="st">"runif"</span>, <span class="st">"Uniform"</span>)</span>
<span id="cb32-9"><a href="#cb32-9"></a>    ),</span>
<span id="cb32-10"><a href="#cb32-10"></a>    <span class="fu">mainPanel</span>(</span>
<span id="cb32-11"><a href="#cb32-11"></a>      <span class="fu">plotOutput</span>(<span class="st">"plot"</span>)</span>
<span id="cb32-12"><a href="#cb32-12"></a>    )</span>
<span id="cb32-13"><a href="#cb32-13"></a>  )</span>
<span id="cb32-14"><a href="#cb32-14"></a>)</span>
<span id="cb32-15"><a href="#cb32-15"></a></span>
<span id="cb32-16"><a href="#cb32-16"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output, session) {</span>
<span id="cb32-17"><a href="#cb32-17"></a>  <span class="co"># Assignment: When "rnorm" button is clicked, the plot should</span></span>
<span id="cb32-18"><a href="#cb32-18"></a>  <span class="co"># show a new batch of rnorm(100). When "runif" button is clicked,</span></span>
<span id="cb32-19"><a href="#cb32-19"></a>  <span class="co"># the plot should show a new batch of runif(100).</span></span>
<span id="cb32-20"><a href="#cb32-20"></a>  </span>
<span id="cb32-21"><a href="#cb32-21"></a>  output<span class="sc">$</span>plot <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb32-22"><a href="#cb32-22"></a>    <span class="fu">hist</span>(<span class="fu">rnorm</span>(<span class="dv">100</span>))</span>
<span id="cb32-23"><a href="#cb32-23"></a>  })</span>
<span id="cb32-24"><a href="#cb32-24"></a>}</span>
<span id="cb32-25"><a href="#cb32-25"></a></span>
<span id="cb32-26"><a href="#cb32-26"></a><span class="fu">shinyApp</span>(ui, server)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="solution-1" class="slide level2">
<h2>Solution</h2>
<div class="sourceCode" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="cf">function</span>(input, output, session) {</span>
<span id="cb33-2"><a href="#cb33-2"></a>  v <span class="ot">&lt;-</span> <span class="fu">reactiveValues</span>(<span class="at">data =</span> <span class="fu">runif</span>(<span class="dv">100</span>))</span>
<span id="cb33-3"><a href="#cb33-3"></a>  </span>
<span id="cb33-4"><a href="#cb33-4"></a>  <span class="fu">observeEvent</span>(input<span class="sc">$</span>runif, {</span>
<span id="cb33-5"><a href="#cb33-5"></a>    v<span class="sc">$</span>data <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">100</span>)</span>
<span id="cb33-6"><a href="#cb33-6"></a>  })</span>
<span id="cb33-7"><a href="#cb33-7"></a>  </span>
<span id="cb33-8"><a href="#cb33-8"></a>  <span class="fu">observeEvent</span>(input<span class="sc">$</span>rnorm, {</span>
<span id="cb33-9"><a href="#cb33-9"></a>    v<span class="sc">$</span>data <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb33-10"><a href="#cb33-10"></a>  })  </span>
<span id="cb33-11"><a href="#cb33-11"></a>  </span>
<span id="cb33-12"><a href="#cb33-12"></a>  output<span class="sc">$</span>plot <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb33-13"><a href="#cb33-13"></a>    <span class="fu">hist</span>(v<span class="sc">$</span>data)</span>
<span id="cb33-14"><a href="#cb33-14"></a>  })</span>
<span id="cb33-15"><a href="#cb33-15"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<aside class="notes">
<p>We’ve identified a number of cases where we should use a reactive expression instead of an <code>observe(Event)</code>/<code>reactiveValues</code> pairing. But there are cases where you simply must use the latter.</p>
<p>There are essentially cases where inputs, outputs, and reactive expressions aren’t powerful enough to natively express the computations you want to perform. So you have the “escape hatch” of <code>observe</code>/<code>reactiveValues</code>; you can do things that would otherwise be impossible, at the price of your code being harder to reason about and harder for the reactive framework to help you with.</p>
<pre><code>    - Accumulating values over time, not just reacting to the latest one
    - Aggregating multiple reactive values/expressions into a single expression
    - Adding artificial latency into reactive values/expressions
    
    In general, we want to stick to reactive expressions whenever possible. And when we really need to, break out the big guns of `observe(Event)`/`reactiveValues`.</code></pre>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="exercise-05-challenge" class="slide level2">
<h2>Exercise 05: Challenge!</h2>
<p><code>Exercise_05.R</code> contains a broken application. See if you can figure out how to fix it!</p>
<p>Read the comments in the file for more details.</p>
<aside class="notes">
<p>Now we have covered three fundamental units of reactivity: state (reactiveValues), calculations (reactive expressions), actions (observers). With these three pieces, we now have our first complete picture of reactivity.</p>
<p>Reactivity tracks <strong>changing state</strong> so that the appropriate <strong>actions</strong> can be taken automatically. In doing so, we specify <strong>calculations</strong> that represent intermediate values. The ideal reactive program always executes <strong>necessary actions</strong> while performing the <strong>minimum number of calculations</strong>. The framework accomplishes this by automatically <strong>tracking dependencies</strong>. There are two pieces we haven’t covered: <code>isolate</code> and <code>invalidateLater</code>. Once we have those two pieces, everything else is accomplished by combining these five primitives:</p>
<ul>
<li><code>reactiveValues()</code></li>
<li><code>reactive()</code></li>
<li><code>observe()</code></li>
<li><code>isolate()</code></li>
<li><code>invalidateLater()</code> Here are just some of the things we can accomplish.</li>
<li><code>input</code></li>
<li><code>output</code>/<code>render</code></li>
<li><code>validate</code> and <code>req</code></li>
<li><code>debounce</code> (see gist)</li>
<li><code>shinySignals</code> (https://github.com/hadley/shinySignals)</li>
<li><code>invokeLater</code> (see gist)</li>
<li><code>observeEvent</code>, <code>eventReactive</code></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="exercise-05---code" class="slide level2">
<h2>Exercise 05 - code</h2>
<div class="sourceCode" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb35-2"><a href="#cb35-2"></a></span>
<span id="cb35-3"><a href="#cb35-3"></a>ui <span class="ot">&lt;-</span> <span class="fu">fillPage</span>(</span>
<span id="cb35-4"><a href="#cb35-4"></a>  <span class="fu">plotOutput</span>(<span class="st">"plot"</span>, <span class="at">click =</span> <span class="st">"click"</span>, <span class="at">height =</span> <span class="st">"100%"</span>)</span>
<span id="cb35-5"><a href="#cb35-5"></a>)</span>
<span id="cb35-6"><a href="#cb35-6"></a></span>
<span id="cb35-7"><a href="#cb35-7"></a><span class="co"># Assignment: This app doesn't work! It's supposed to let</span></span>
<span id="cb35-8"><a href="#cb35-8"></a><span class="co"># the user click on the plot, and have a data point appear</span></span>
<span id="cb35-9"><a href="#cb35-9"></a><span class="co"># where the click occurs. But as written, the data point</span></span>
<span id="cb35-10"><a href="#cb35-10"></a><span class="co"># only appears for a moment before disappearing.</span></span>
<span id="cb35-11"><a href="#cb35-11"></a><span class="co"># </span></span>
<span id="cb35-12"><a href="#cb35-12"></a><span class="co"># This happens because each time the plot is re-rendered,</span></span>
<span id="cb35-13"><a href="#cb35-13"></a><span class="co"># the value of input$click is reset to NULL, and thus</span></span>
<span id="cb35-14"><a href="#cb35-14"></a><span class="co"># userPoint() becomes NULL as well.</span></span>
<span id="cb35-15"><a href="#cb35-15"></a><span class="co"># </span></span>
<span id="cb35-16"><a href="#cb35-16"></a><span class="co"># Can you get a single user-added data point to stay?</span></span>
<span id="cb35-17"><a href="#cb35-17"></a><span class="co"># </span></span>
<span id="cb35-18"><a href="#cb35-18"></a><span class="co"># Bonus points: Can you include not just the single most</span></span>
<span id="cb35-19"><a href="#cb35-19"></a><span class="co"># recent click, but ALL clicks made by the user?</span></span>
<span id="cb35-20"><a href="#cb35-20"></a><span class="co"># </span></span>
<span id="cb35-21"><a href="#cb35-21"></a><span class="co"># Hint: You'll need to replace reactive() with a combo</span></span>
<span id="cb35-22"><a href="#cb35-22"></a><span class="co"># of reactiveValues() and observeEvent().</span></span>
<span id="cb35-23"><a href="#cb35-23"></a></span>
<span id="cb35-24"><a href="#cb35-24"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output, session) {</span>
<span id="cb35-25"><a href="#cb35-25"></a>  <span class="co"># Either NULL, or a 1-row data frame that represents</span></span>
<span id="cb35-26"><a href="#cb35-26"></a>  <span class="co"># the point that the user clicked on the plot</span></span>
<span id="cb35-27"><a href="#cb35-27"></a>  userPoint <span class="ot">&lt;-</span> <span class="fu">reactive</span>({</span>
<span id="cb35-28"><a href="#cb35-28"></a>    <span class="co"># input$click will be either NULL or list(x=num, y=num)</span></span>
<span id="cb35-29"><a href="#cb35-29"></a>    click <span class="ot">&lt;-</span> input<span class="sc">$</span>click</span>
<span id="cb35-30"><a href="#cb35-30"></a>    </span>
<span id="cb35-31"><a href="#cb35-31"></a>    <span class="cf">if</span> (<span class="fu">is.null</span>(click)) {</span>
<span id="cb35-32"><a href="#cb35-32"></a>      <span class="co"># The user didn't click on the plot (or the previous</span></span>
<span id="cb35-33"><a href="#cb35-33"></a>      <span class="co"># click was cleared by the plot being re-rendered)</span></span>
<span id="cb35-34"><a href="#cb35-34"></a>      <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb35-35"><a href="#cb35-35"></a>    }</span>
<span id="cb35-36"><a href="#cb35-36"></a>    </span>
<span id="cb35-37"><a href="#cb35-37"></a>    <span class="fu">data.frame</span>(<span class="at">speed =</span> click<span class="sc">$</span>x, <span class="at">dist =</span> click<span class="sc">$</span>y)</span>
<span id="cb35-38"><a href="#cb35-38"></a>  })</span>
<span id="cb35-39"><a href="#cb35-39"></a>  </span>
<span id="cb35-40"><a href="#cb35-40"></a>  output<span class="sc">$</span>plot <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb35-41"><a href="#cb35-41"></a>    <span class="co"># Before plotting, combine the original dataset with</span></span>
<span id="cb35-42"><a href="#cb35-42"></a>    <span class="co"># the user data. (rbind ignores NULL args.)</span></span>
<span id="cb35-43"><a href="#cb35-43"></a>    df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(cars, <span class="fu">userPoint</span>())</span>
<span id="cb35-44"><a href="#cb35-44"></a>    <span class="fu">plot</span>(df, <span class="at">pch =</span> <span class="dv">19</span>)</span>
<span id="cb35-45"><a href="#cb35-45"></a>    </span>
<span id="cb35-46"><a href="#cb35-46"></a>    model <span class="ot">&lt;-</span> <span class="fu">lm</span>(dist <span class="sc">~</span> speed, df)</span>
<span id="cb35-47"><a href="#cb35-47"></a>    <span class="fu">abline</span>(model)</span>
<span id="cb35-48"><a href="#cb35-48"></a>  })</span>
<span id="cb35-49"><a href="#cb35-49"></a>}</span>
<span id="cb35-50"><a href="#cb35-50"></a></span>
<span id="cb35-51"><a href="#cb35-51"></a><span class="fu">shinyApp</span>(ui, server)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="solution-05---version-a" class="slide level2">
<h2>Solution 05 - version a</h2>
<div class="sourceCode" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb36-2"><a href="#cb36-2"></a></span>
<span id="cb36-3"><a href="#cb36-3"></a>ui <span class="ot">&lt;-</span> <span class="fu">fillPage</span>(</span>
<span id="cb36-4"><a href="#cb36-4"></a>  <span class="fu">plotOutput</span>(<span class="st">"plot"</span>, <span class="at">click =</span> <span class="st">"click"</span>, <span class="at">height =</span> <span class="st">"100%"</span>)</span>
<span id="cb36-5"><a href="#cb36-5"></a>)</span>
<span id="cb36-6"><a href="#cb36-6"></a></span>
<span id="cb36-7"><a href="#cb36-7"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output, session) {</span>
<span id="cb36-8"><a href="#cb36-8"></a>  <span class="co"># Instead of a reactive expression for userPoint, we</span></span>
<span id="cb36-9"><a href="#cb36-9"></a>  <span class="co"># use a reactive value. This gives us more control</span></span>
<span id="cb36-10"><a href="#cb36-10"></a>  <span class="co"># over when userPoint gets updated.</span></span>
<span id="cb36-11"><a href="#cb36-11"></a>  rv <span class="ot">&lt;-</span> <span class="fu">reactiveValues</span>(<span class="at">userPoint =</span> <span class="cn">NULL</span>)</span>
<span id="cb36-12"><a href="#cb36-12"></a>  </span>
<span id="cb36-13"><a href="#cb36-13"></a>  <span class="fu">observeEvent</span>(input<span class="sc">$</span>click, {</span>
<span id="cb36-14"><a href="#cb36-14"></a>    <span class="co"># Replace rv$userPoint, but only if input$click isn't NULL</span></span>
<span id="cb36-15"><a href="#cb36-15"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(input<span class="sc">$</span>click)) {</span>
<span id="cb36-16"><a href="#cb36-16"></a>      rv<span class="sc">$</span>userPoint <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb36-17"><a href="#cb36-17"></a>        <span class="at">speed =</span> input<span class="sc">$</span>click<span class="sc">$</span>x,</span>
<span id="cb36-18"><a href="#cb36-18"></a>        <span class="at">dist =</span> input<span class="sc">$</span>click<span class="sc">$</span>y</span>
<span id="cb36-19"><a href="#cb36-19"></a>      )</span>
<span id="cb36-20"><a href="#cb36-20"></a>    }</span>
<span id="cb36-21"><a href="#cb36-21"></a>  })</span>
<span id="cb36-22"><a href="#cb36-22"></a>  </span>
<span id="cb36-23"><a href="#cb36-23"></a>  output<span class="sc">$</span>plot <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb36-24"><a href="#cb36-24"></a>    <span class="co"># Now refers to rv$userPoint instead of userPoint().</span></span>
<span id="cb36-25"><a href="#cb36-25"></a>    df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(cars, rv<span class="sc">$</span>userPoint)</span>
<span id="cb36-26"><a href="#cb36-26"></a>    <span class="fu">plot</span>(df, <span class="at">pch =</span> <span class="dv">19</span>)</span>
<span id="cb36-27"><a href="#cb36-27"></a>    </span>
<span id="cb36-28"><a href="#cb36-28"></a>    model <span class="ot">&lt;-</span> <span class="fu">lm</span>(dist <span class="sc">~</span> speed, df)</span>
<span id="cb36-29"><a href="#cb36-29"></a>    <span class="fu">abline</span>(model)</span>
<span id="cb36-30"><a href="#cb36-30"></a>  })</span>
<span id="cb36-31"><a href="#cb36-31"></a>}</span>
<span id="cb36-32"><a href="#cb36-32"></a></span>
<span id="cb36-33"><a href="#cb36-33"></a><span class="fu">shinyApp</span>(ui, server)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="solution-05---version-b" class="slide level2">
<h2>Solution 05 - version b</h2>
<div class="sourceCode" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb37-2"><a href="#cb37-2"></a></span>
<span id="cb37-3"><a href="#cb37-3"></a>ui <span class="ot">&lt;-</span> <span class="fu">fillPage</span>(</span>
<span id="cb37-4"><a href="#cb37-4"></a>  <span class="fu">plotOutput</span>(<span class="st">"plot"</span>, <span class="at">click =</span> <span class="st">"click"</span>, <span class="at">height =</span> <span class="st">"100%"</span>)</span>
<span id="cb37-5"><a href="#cb37-5"></a>)</span>
<span id="cb37-6"><a href="#cb37-6"></a></span>
<span id="cb37-7"><a href="#cb37-7"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output, session) {</span>
<span id="cb37-8"><a href="#cb37-8"></a>  rv <span class="ot">&lt;-</span> <span class="fu">reactiveValues</span>(<span class="at">userPoints =</span> <span class="cn">NULL</span>)</span>
<span id="cb37-9"><a href="#cb37-9"></a>  </span>
<span id="cb37-10"><a href="#cb37-10"></a>  <span class="co"># Same as Solution_05a.R, but instead of keeping</span></span>
<span id="cb37-11"><a href="#cb37-11"></a>  <span class="co"># track of the single most recent point, we accumulate</span></span>
<span id="cb37-12"><a href="#cb37-12"></a>  <span class="co"># all previous points using rbind().</span></span>
<span id="cb37-13"><a href="#cb37-13"></a>  <span class="fu">observeEvent</span>(input<span class="sc">$</span>click, {</span>
<span id="cb37-14"><a href="#cb37-14"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(input<span class="sc">$</span>click)) {</span>
<span id="cb37-15"><a href="#cb37-15"></a>      thisPoint <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb37-16"><a href="#cb37-16"></a>        <span class="at">speed =</span> input<span class="sc">$</span>click<span class="sc">$</span>x,</span>
<span id="cb37-17"><a href="#cb37-17"></a>        <span class="at">dist =</span> input<span class="sc">$</span>click<span class="sc">$</span>y</span>
<span id="cb37-18"><a href="#cb37-18"></a>      )</span>
<span id="cb37-19"><a href="#cb37-19"></a>      rv<span class="sc">$</span>userPoints <span class="ot">&lt;-</span> <span class="fu">rbind</span>(rv<span class="sc">$</span>userPoints, thisPoint)</span>
<span id="cb37-20"><a href="#cb37-20"></a>    }</span>
<span id="cb37-21"><a href="#cb37-21"></a>  })</span>
<span id="cb37-22"><a href="#cb37-22"></a>  </span>
<span id="cb37-23"><a href="#cb37-23"></a>  output<span class="sc">$</span>plot <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb37-24"><a href="#cb37-24"></a>    df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(cars, rv<span class="sc">$</span>userPoints)</span>
<span id="cb37-25"><a href="#cb37-25"></a>    <span class="fu">plot</span>(df, <span class="at">pch =</span> <span class="dv">19</span>)</span>
<span id="cb37-26"><a href="#cb37-26"></a>    </span>
<span id="cb37-27"><a href="#cb37-27"></a>    model <span class="ot">&lt;-</span> <span class="fu">lm</span>(dist <span class="sc">~</span> speed, df)</span>
<span id="cb37-28"><a href="#cb37-28"></a>    <span class="fu">abline</span>(model)</span>
<span id="cb37-29"><a href="#cb37-29"></a>  })</span>
<span id="cb37-30"><a href="#cb37-30"></a>}</span>
<span id="cb37-31"><a href="#cb37-31"></a></span>
<span id="cb37-32"><a href="#cb37-32"></a><span class="fu">shinyApp</span>(ui, server)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="exercise-6-use-eventreactive-to-restrict-when-calculations-invalidate" class="slide level2">
<h2>Exercise 6: Use eventReactive to restrict when calculations invalidate</h2>
<p><strong>Concept:</strong> Tie expensive calculations to action buttons.</p>
<p><strong>Exercise:</strong> <strong>Anti-pattern:</strong> Using observeEvent and reactiveValues.</p>
<p>Let’s go back and take a look at <code>observe</code> and <code>observeEvent</code>. They’re both used for actions, that is to say, side effects. They differ in that <code>observe</code> <em>implicitly</em> takes a reactive dependency on everything it reads—a change in anything will cause it to re-execute—while <code>observeEvent</code> only re-executes based on what you <em>explicitly</em> tell it to.</p>
<ul>
<li class="fragment">Action, implicit reactivity: <code>observe</code></li>
<li class="fragment">Action, explicit reactivity: <code>observeEvent</code></li>
<li class="fragment">Calculation, implicit reactivity:<code>reactive</code></li>
<li class="fragment">Calculation, explicit reactivity: <code>eventReactive</code></li>
<li class="fragment">Similarly, <code>eventReactive</code> is for declaring calculations that only invalidate based on what you <em>explicitly</em> tell it to. 99% of the time, it’s going to be action buttons.</li>
</ul>
</section>
<section id="exercise-7-checking-preconditions-with-req" class="slide level2">
<h2>Exercise 7: Checking preconditions with req</h2>
<p><strong>Concept:</strong> <code>req</code> is a lightweight way to achieve cascading stopping of executions, that aren’t error conditions.</p>
<p><strong>Exercise:</strong> <strong>Anti-pattern:</strong></p>
</section>
<section id="invalidatelater" class="slide level2">
<h2>invalidateLater</h2>
<p><strong>Concept:</strong> Use for anything that might change in the “real world” but not have any inherent effect on reactivity on its own.</p>
<p><strong>Exercise:</strong> <strong>Anti-pattern:</strong> Just using non-reactive things and expecting them to behave reactively.</p>
</section>
<section id="higher-order-reactives-bonus" class="slide level2">
<h2>Higher order reactives (bonus)</h2>
<p><strong>Concept:</strong> Use reactive expressions as the primary unit to compute on, when writing higher-order reactives. Inputs and outputs should both be reactive expressions.</p>
</section>
<section id="links" class="slide level2">
<h2>Links</h2>
<p><a href="https://www.rstudio.com/resources/shiny-dev-con/reactivity-pt-1-joe-cheng/" class="uri">https://www.rstudio.com/resources/shiny-dev-con/reactivity-pt-1-joe-cheng/</a> <a href="https://www.rstudio.com/resources/shiny-dev-con/reactivity-pt-2/" class="uri">https://www.rstudio.com/resources/shiny-dev-con/reactivity-pt-2/</a> <a href="https://github.com/rstudio/ShinyDeveloperConference" class="uri">https://github.com/rstudio/ShinyDeveloperConference</a></p>
<div class="footer footer-default">

</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="index_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="index_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="index_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="index_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="index_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="index_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="index_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="index_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="index_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="index_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        target: function(trigger) {
          return trigger.previousElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        setTimeout(function() {
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto-reveal',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          let href = ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const cites = ref.parentNode.getAttribute('data-cites').split(' ');
        tippyHover(ref, function() {
          var popup = window.document.createElement('div');
          cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    });
    </script>
    

</body></html>